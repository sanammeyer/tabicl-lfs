{
  "args": {
    "batch_size": 8,
    "datasets": "car,steel-plates-fault,wall-robot-navigation",
    "device": "auto",
    "fold": 0,
    "head_swap": false,
    "max_pairs": 250000,
    "n_estimators": 32,
    "no_save": false,
    "openml_tasks": null,
    "out_dir": "results/pdl_head_diag",
    "pdl_agg_sweep": null,
    "pdl_checkpoint": "checkpoints_mini_tabicl_stage2_pdl/step-1000.ckpt",
    "pdl_embed_norm_sweep": null,
    "pdl_infer_temp_sweep": null,
    "pdl_topk_sweep": null,
    "pdlc_agg": "posterior_avg",
    "pdlc_inference_temperature": null,
    "sa_checkpoint": "checkpoints_mini_tabicl_stage2_sa/step-1000.ckpt",
    "seed": 42,
    "softmax_temperature": 0.9,
    "test_size": 0.5,
    "use_amp": false,
    "variant": "identity",
    "verbose": false
  },
  "datasets": [
    {
      "dataset_id": 40975,
      "dataset_name": "car",
      "head_swap": null,
      "models": {
        "pdl": {
          "acc": 0.9074074074074074,
          "confusion": [
            [
              188,
              0,
              4,
              0
            ],
            [
              35,
              0,
              0,
              0
            ],
            [
              9,
              0,
              596,
              0
            ],
            [
              32,
              0,
              0,
              0
            ]
          ],
          "margin_mean": 0.8141824225097446,
          "margin_median": 0.9384713703766465,
          "margin_p10": 0.5326347634196281,
          "margin_p90": 0.9386201245710254,
          "n_classes": 4,
          "n_predicted_classes": 2,
          "n_test": 864,
          "per_class_recall": [
            0.9791666666666666,
            0.0,
            0.9851239669421488,
            0.0
          ],
          "pred_counts": [
            264,
            0,
            600,
            0
          ],
          "pred_entropy": 0.615498282275913,
          "pred_top1_frac": 0.6944444444444444,
          "pred_top2_frac": 0.3055555555555556
        },
        "sa": {
          "acc": 0.9756944444444444,
          "confusion": [
            [
              184,
              3,
              4,
              1
            ],
            [
              2,
              31,
              0,
              2
            ],
            [
              8,
              0,
              597,
              0
            ],
            [
              1,
              0,
              0,
              31
            ]
          ],
          "margin_mean": 0.9525006213078131,
          "margin_median": 0.9998273361779866,
          "margin_p10": 0.8850749362260103,
          "margin_p90": 0.9999589110094348,
          "n_classes": 4,
          "n_predicted_classes": 4,
          "n_test": 864,
          "per_class_recall": [
            0.9583333333333334,
            0.8857142857142857,
            0.9867768595041322,
            0.96875
          ],
          "pred_counts": [
            195,
            34,
            601,
            34
          ],
          "pred_entropy": 0.8430739432838134,
          "pred_top1_frac": 0.6956018518518519,
          "pred_top2_frac": 0.22569444444444445
        }
      },
      "n_features": 6,
      "n_rows": 1728,
      "pdl_gamma": {
        "ap": 0.9922102788875876,
        "auc": 0.9922195995002161,
        "gamma_diff_mean": 0.23139082450929993,
        "gamma_diff_p10": 0.011842485517263412,
        "gamma_diff_p90": 0.583023190498352,
        "gamma_same_mean": 0.9358392461402498,
        "gamma_same_p10": 0.830236566066742,
        "gamma_same_p90": 0.97720285654068,
        "n_pairs_used": 250000,
        "n_support": 864
      },
      "split": {
        "kind": "random_stratified",
        "seed": 42,
        "test_size": 0.5
      },
      "variant": {
        "X_shape": [
          1728,
          6
        ],
        "class_shift_offset": 2,
        "feature_permutation": [
          0,
          3,
          1,
          5,
          2,
          4
        ],
        "norm_method": "none",
        "test_size": 864,
        "train_size": 864,
        "variant_index": 0,
        "y_train_shifted_shape": [
          864
        ]
      },
      "variant_runs": []
    },
    {
      "dataset_id": 40982,
      "dataset_name": "steel-plates-fault",
      "head_swap": null,
      "models": {
        "pdl": {
          "acc": 0.5612770339855818,
          "confusion": [
            [
              40,
              0,
              0,
              161,
              0,
              0,
              0
            ],
            [
              0,
              0,
              0,
              27,
              0,
              0,
              0
            ],
            [
              0,
              0,
              179,
              17,
              0,
              0,
              0
            ],
            [
              6,
              0,
              5,
              326,
              0,
              0,
              0
            ],
            [
              0,
              0,
              0,
              79,
              0,
              0,
              0
            ],
            [
              0,
              0,
              1,
              35,
              0,
              0,
              0
            ],
            [
              0,
              0,
              0,
              95,
              0,
              0,
              0
            ]
          ],
          "margin_mean": 0.20065559282607326,
          "margin_median": 0.20806676149368286,
          "margin_p10": 0.04579634964466095,
          "margin_p90": 0.3755030333995819,
          "n_classes": 7,
          "n_predicted_classes": 3,
          "n_test": 971,
          "per_class_recall": [
            0.19900497512437812,
            0.0,
            0.9132653061224489,
            0.9673590504451038,
            0.0,
            0.0,
            0.0
          ],
          "pred_counts": [
            46,
            0,
            185,
            740,
            0,
            0,
            0
          ],
          "pred_entropy": 0.6674052842906371,
          "pred_top1_frac": 0.7621009268795057,
          "pred_top2_frac": 0.19052523171987643
        },
        "sa": {
          "acc": 0.7507723995880535,
          "confusion": [
            [
              116,
              1,
              0,
              75,
              7,
              0,
              2
            ],
            [
              1,
              23,
              0,
              3,
              0,
              0,
              0
            ],
            [
              0,
              0,
              182,
              14,
              0,
              0,
              0
            ],
            [
              55,
              6,
              7,
              245,
              10,
              4,
              10
            ],
            [
              10,
              0,
              1,
              19,
              48,
              0,
              1
            ],
            [
              0,
              0,
              0,
              5,
              0,
              31,
              0
            ],
            [
              1,
              0,
              0,
              10,
              0,
              0,
              84
            ]
          ],
          "margin_mean": 0.6513205006923711,
          "margin_median": 0.7213349863886833,
          "margin_p10": 0.15376406908035278,
          "margin_p90": 0.9953333691228181,
          "n_classes": 7,
          "n_predicted_classes": 7,
          "n_test": 971,
          "per_class_recall": [
            0.5771144278606966,
            0.8518518518518519,
            0.9285714285714286,
            0.7270029673590505,
            0.6075949367088608,
            0.8611111111111112,
            0.8842105263157894
          ],
          "pred_counts": [
            183,
            30,
            190,
            371,
            65,
            35,
            97
          ],
          "pred_entropy": 1.6396686454613874,
          "pred_top1_frac": 0.3820803295571576,
          "pred_top2_frac": 0.1956745623069001
        }
      },
      "n_features": 27,
      "n_rows": 1941,
      "pdl_gamma": {
        "ap": 0.3586482890667628,
        "auc": 0.7594741122166353,
        "gamma_diff_mean": 0.47298199587373746,
        "gamma_diff_p10": 0.09192955121397972,
        "gamma_diff_p90": 0.8874112367630005,
        "gamma_same_mean": 0.7287053782306154,
        "gamma_same_p10": 0.5103371560573577,
        "gamma_same_p90": 0.8879176795482636,
        "n_pairs_used": 250000,
        "n_support": 970
      },
      "split": {
        "kind": "random_stratified",
        "seed": 42,
        "test_size": 0.5
      },
      "variant": {
        "X_shape": [
          1941,
          27
        ],
        "class_shift_offset": 4,
        "feature_permutation": [
          24,
          0,
          22,
          15,
          10,
          5,
          6,
          13,
          12,
          8,
          1,
          20,
          25,
          11,
          19,
          21,
          26,
          23,
          17,
          16,
          2,
          4,
          3,
          7,
          18,
          14,
          9
        ],
        "norm_method": "none",
        "test_size": 971,
        "train_size": 970,
        "variant_index": 0,
        "y_train_shifted_shape": [
          970
        ]
      },
      "variant_runs": []
    },
    {
      "dataset_id": 1497,
      "dataset_name": "wall-robot-navigation",
      "head_swap": null,
      "models": {
        "pdl": {
          "acc": 0.8786656891495601,
          "confusion": [
            [
              1068,
              32,
              0,
              3
            ],
            [
              27,
              1021,
              0,
              0
            ],
            [
              84,
              80,
              0,
              0
            ],
            [
              95,
              10,
              0,
              308
            ]
          ],
          "margin_mean": 0.48244520471242863,
          "margin_median": 0.6235888451337814,
          "margin_p10": 0.06790571510791779,
          "margin_p90": 0.6496335789561272,
          "n_classes": 4,
          "n_predicted_classes": 3,
          "n_test": 2728,
          "per_class_recall": [
            0.9682683590208522,
            0.9742366412213741,
            0.0,
            0.7457627118644068
          ],
          "pred_counts": [
            1274,
            1143,
            0,
            311
          ],
          "pred_entropy": 0.9676278398440284,
          "pred_top1_frac": 0.4670087976539589,
          "pred_top2_frac": 0.4189882697947214
        },
        "sa": {
          "acc": 0.9618768328445748,
          "confusion": [
            [
              1052,
              31,
              4,
              16
            ],
            [
              27,
              1019,
              2,
              0
            ],
            [
              5,
              4,
              155,
              0
            ],
            [
              13,
              2,
              0,
              398
            ]
          ],
          "margin_mean": 0.9378478070675738,
          "margin_median": 0.9988930277177133,
          "margin_p10": 0.8133096061646938,
          "margin_p90": 0.9999729860534898,
          "n_classes": 4,
          "n_predicted_classes": 4,
          "n_test": 2728,
          "per_class_recall": [
            0.9537624660018132,
            0.9723282442748091,
            0.9451219512195121,
            0.9636803874092009
          ],
          "pred_counts": [
            1097,
            1056,
            161,
            414
          ],
          "pred_entropy": 1.1868699804321134,
          "pred_top1_frac": 0.40212609970674484,
          "pred_top2_frac": 0.3870967741935484
        }
      },
      "n_features": 24,
      "n_rows": 5456,
      "pdl_gamma": {
        "ap": 0.8035733307174134,
        "auc": 0.9174515597459518,
        "gamma_diff_mean": 0.322939556360424,
        "gamma_diff_p10": 0.03712297379970551,
        "gamma_diff_p90": 0.78231407403946,
        "gamma_same_mean": 0.8186526174933025,
        "gamma_same_p10": 0.5910567879676819,
        "gamma_same_p90": 0.9611030101776123,
        "n_pairs_used": 250000,
        "n_support": 2728
      },
      "split": {
        "kind": "random_stratified",
        "seed": 42,
        "test_size": 0.5
      },
      "variant": {
        "X_shape": [
          5456,
          24
        ],
        "class_shift_offset": 3,
        "feature_permutation": [
          6,
          7,
          4,
          2,
          13,
          8,
          18,
          19,
          22,
          9,
          20,
          3,
          15,
          23,
          10,
          17,
          1,
          21,
          11,
          0,
          14,
          16,
          5,
          12
        ],
        "norm_method": "none",
        "test_size": 2728,
        "train_size": 2728,
        "variant_index": 0,
        "y_train_shifted_shape": [
          2728
        ]
      },
      "variant_runs": []
    }
  ]
}